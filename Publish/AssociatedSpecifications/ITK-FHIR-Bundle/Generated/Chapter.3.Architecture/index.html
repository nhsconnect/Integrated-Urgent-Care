


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
			<title>ITK FHIR Distribution - FHIR Implementation Guide</title>

			<meta name="viewport" content="width=device-width, initial-scale=1.0" />
			<meta name="author" content="HSCIC" />        
			<meta name="publisher version" content=	"FHIR-Furnace : 2.7.6256.31052" />
		
			<link href="../dist/css/fhir.css" rel="stylesheet" />
	 
			<!-- Bootstrap core CSS -->
			<link href="../dist/css/bootstrap.css" rel="stylesheet" />
			<link href="../dist/css/bootstrap-fhir.css" rel="stylesheet" />
			<link href="../dist/css/bootstrap-glyphicons.css" rel="stylesheet" />

			<!-- Project extras -->
			
			<link href="../dist/css/pygments-manni.css" rel="stylesheet" />

			<script src="../dist/js/jquery.js"> </script>
			<script src="../dist/js/bootstrap.min.js"> </script>

			<script src="../dist/js/fhir.js"> </script>
			
				<script>
				  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
				  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

				  ga('create', 'UA-67795986-1', 'auto');
				  ga('send', 'pageview');

				</script>
			
			<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
			<!--[if lt IE 9]>
				<script src="../dist/js/html5shiv.js"></script>
				<script src="../dist/js/respond.min.js"></script>
			<![endif]-->

			<!-- Favicons -->
			<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../dist/images/apple-touch-icon-144-precomposed.png" />
			<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../dist/images/apple-touch-icon-114-precomposed.png" />
			<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../dist/images/apple-touch-icon-72-precomposed.png" />
			<link rel="apple-touch-icon-precomposed" href="../dist/images/apple-touch-icon-57-precomposed.png" />
			<link rel="shortcut icon" href="../dist/images/favicon.ico" />
	</head>
	
	<body>  
		
		<!-- segment-header -->
		<div id="segment-header" class="segment">
            
            <div class="container">
                <!-- container -->
                <a id="logo" href="http://www.digital.nhs.uk" target="_blank">
                    <img src="../dist/images/logo.png" alt="logo NHS Digital" />
                </a>
                <div id="specificationName">
         
                        <b>ITK FHIR Distribution</b>
                  
                </div>

            </div>
            <div class="container">
                <!-- container -->
            </div>
        </div>
        
		<!-- /segment-header -->
		
		
		<div id="segment-navbar" class="segment">
            <!-- segment-navbar -->
            <div id="stripe"> </div>
            <div class="container">
                <!-- container -->
                <!-- HEADER CONTENT -->

                <nav class="navbar navbar-inverse">
                    <div class="container">
                        <button data-target=".navbar-inverse-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
                            <span class="icon-bar"> </span>
                            <span class="icon-bar"> </span>
                            <span class="icon-bar"> </span>
                        </button>
                        <div class="nav-collapse collapse navbar-inverse-collapse">
                            <ul class="nav navbar-nav">   

											<li>
												<a href='../Chapter.1.About/index.html'>About</a>
											</li>
											<li>
												<a href='../Chapter.2.Change History/index.html'>Change History</a>
											</li>
											<li>
												<a href='../Chapter.3.Architecture/index.html'>Architecture</a>
											</li>
											<li>
												<a href='../Chapter.4.FHIR Constrained Messages/index.html'>FHIR Constrained Messages</a>
											</li>
											<li>
												<a href='../Chapter.5.Examples/examples.html'>Examples</a>
											</li>
											<li>
												<a href='../Chapter.6.Glossary/index.html'>Glossary</a>
											</li>

                            </ul>
							
                            <p class="navbar-text pull-right" style="padding-right: 10px;padding-top: 3px;">
                                <span class="label label-default"  style="font-size: 95%;">Version 1.0 : DRAFT A</span>
                            </p>

                        </div>
                    </div>
                </nav>				
            </div>
        </div>
		
		<div id="segment-breadcrumb" class="segment">
            <!-- segment-breadcrumb -->
            <div class="container">
                <!-- container -->
                <ul class="breadcrumb"></ul>
            </div>
            <!-- /container -->
        </div>
        <div id="segment-content" class="segment">
            <!-- segment-content -->
            <div class="container">
                <!-- container -->
                <div class="row">
                    <div class="inner-wrapper">
						<!-- CONTENT CONTENT -->
                        <div class="col-12">
							
							
							
							
							
									<div class="panel panel - default">
											<h1>FHIR Messaging Architecture</h1>
<h2>ITK FHIR Overview</h2>
<p>This section provides ITK implementers with the information required to utilise the ITK FHIR distribution Domain Message Specification.</p>
<p>The ITK FHIR distribution provides a consistent standardised approach to message headers, whilst also providing a message handling specification to control the use of infrastructure and business acknowledgement responses through the use of flags.</p>
<p><strong>Note 1:</strong> When using MESH, additional MESH acknowledgements and responses will be available.  The MESH acknowledgements and responses are not defined in this specification</p>
<p><strong>Note 2:</strong> Messages are structured in eXtensible Markup Language (XML) only.</p>
<p>The ITK FHIR distribution is based on the <a href="http://hl7.org/fhir/messaging.html">HL7 FHIR DSTU2 Messaging Implementation</a> Messaging Implementation and supports multiple interactions. </p>
<hr />
<h2>Message Handling Flags</h2>
<p>Acknowledgement responses can be requested using the message handling as follows:</p>
<ul>
<li><em>Key</em> - INFACK / BUSACK</li>
<li><em>Value</em> - true or false</li>
</ul>
<p><strong>Note: When sending a payload bundle the acknowledgement type should be set to &quot;true&quot;.</strong></p>
<p>The following additional message handling specifications are supported:</p>
<ul>
<li><em>Key</em> - PID / INTID / SNDSRVC</li>
<li><em>Value</em> - string</li>
</ul>
<p>These flags are configured within the <a href="../Profile.ITKSendPayload\itk-messageheader-1.html">ITK-MessageHeader-1</a></p>
<hr />
<h2><a name="RSP-ITK-Infrastructure-Acknowledgement-Response-1"></a>RSP-ITK-Infrastructure-Acknowledgement-Response-1 Interaction</h2>
<p>The sending system may request an infrastructure acknowledgement by setting the message handling key to &quot;INFACK&quot; and the value to &quot;true&quot;. The recipient system should construct an infrastructure acknowledgement response and return it to the sending system.</p>
<ul>
<li><em>Sender:</em> Sending System</li>
<li><em>Receiver:</em> Recipient System</li>
<li><em>Message: Wire Format:</em> <a href="../Profile.ITKInfAckResponse\Profile.ITKInfAckResponse.html">ITKInfAckresponse-1</a></li>
</ul>
<hr />
<h2><a name="RSP-ITK-Business-Acknowledgement-Response-1"></a>RSP-ITK-Business-Acknowledgement-Response-1 Interactions</h2>
<p>The sending system may request a business acknowledgement by setting the message handling key to &quot;BUSACK&quot; and the value to &quot;true&quot;. The recipient system should construct a business acknowledgement response and return it to the sending system.</p>
<ul>
<li><em>Sender:</em> Sending System</li>
<li><em>Receiver:</em> Recipient System</li>
<li><em>Message: Wire Format:</em> <a href="../Profile.ITKBusinessAckResponse\Profile.ITKBusinessAckResponse.html">ITKBusinessAckresponse-1</a></li>
</ul>
<hr />
<h2>ITK Interaction Diagram</h2>
<p><br>
The diagram shows the ITK FHIR distribution payload and acknowledgement interactions:
<br></p>
<div style="display: block;"><img  src="ITKFHIRInteractions.png" alt="Interactions"></div>
<p><br></p>
<h2>Example Interactions</h2>
<h3>Incorrectly Formed Payload</h3>
<p>The diagram shows the eDischarge document sent from a Hospital system to a GP practice.  On receipt of the eDischarge document, the GP system detects a structural error caused by a missing mandatory value in the eDischarge document.  The GP system sends an ITK Infrastructure Acknowledgement Response carrying a code for a &quot;fatal-error&quot; to the Hospital System.  This alerts the hospital that the original eDischarge document was rejected because of some of the content in it, and there is no point in resending it without making the appropriate change.
<br></p>
<div style="display: block;"><img  src="ITKFHIRStructuralErrorInteractions.png" alt="Interactions"></div>
<p><br></p>
<h3>Patient Not Registered at the GP Practice</h3>
<p>The diagram shows the eDischarge document sent from a Hospital system to a GP practice.  On receipt of this eDischarge document, the GP system sends an ITK Infrastructure Acknowledgement Response carrying a code of &quot;OK&quot; to the hospital system, this indicates that the message was delivered to the GP practice.  Later that day, the GP system cross checks the details of the patient in that eDischarge Document against it's list of registered patients and detects that the patient's NHS number is not known, indicating that the patient is not registered at this practice.  The GP system sends an ITK Business Acknowledgement Response message, carrying information to inform the Hospital System of the nature of the problem, for example the ITK Business Acknowledgement Response message could carry information such as:  </p>
<ul>
<li>&quot;error&quot; - a code to indicate the issue is sufficiently important to cause the action to fail.</li>
<li>&quot;business-rule&quot; - a code to indicate the operation failed to pass some business rule, and so could not proceed.</li>
<li>&quot;41002&quot; - a code describing that the &quot;patient not known here&quot; (indicating &quot;patient record not present in system&quot;).</li>
<li>&quot;this patient is not registered at this GP practice&quot; - a free text description of the actual issue itself.</li>
</ul>
<p>The hospital system, on receipt of this ITK Business Acknowledgement Response, sends an ITK Infrastructure Acknowledgement Response, to advise the GP practice that the hospital has received the information from the GP practice concerning the invalid NHS number.
<br></p>
<div style="display: block;"><img  src="ITKFHIRBusinessErrorInteractions.png" alt="Interactions"></div>
<p><br></p>
<p><strong>Further Information</strong></p>
<p>For more information about FHIR messaging please visit: <a href="http://hl7.org/fhir/messaging.html">HL7 FHIR DSTU2 Messaging Implementation</a>.</p>
<p>Quick links to FHIR reference implementations and implementation tool downloads are available from the <a href="http://hl7.org/fhir/index.html">FHIR DSTU2</a> specification.</p>

									</div>
							
						
					   </div>                      
                    </div>
                    <!-- /inner-wrapper -->                   
                </div>
                <!-- /row -->              
            </div>
            <!-- /container -->           
        </div>
    <!-- /segment-content -->

        <div id="segment-footer" class="segment">
            <!-- segment-footer -->
            <div class="container">
                <!-- container -->
                <div class="inner-wrapper">
					<div id="explanatoryline">
                         <img src="../dist/images/explanatoryline.png" alt="Information and technology for better health and care" />
						 <p>
                        Copyright &copy; 2017 Health and Social Care Information Centre<br/>
						NHS Digital is the trading name of the Health and Social Care Information Centre.
                    </p>
                    </div>
				<div id="hl7-nav">
                    <a id="hl7-logo" href="http://www.hl7.org" target="_blank">
                        <img src="../dist/images/hl7-logo.png" alt="visit the hl7 website" />
                    </a>
					<p>
					FHIR&reg; is the registered trademark of HL7<br/>
					and is used with the permission of HL7.
					</p>
				</div>
					<p>
						<!--<span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> -->
                    </p>
                </div>
                <!-- /inner-wrapper -->
            </div>
            <!-- /container -->
        </div>

        <div id="segment-post-footer" class="segment">
            <!-- segment-post-footer -->
            <div class="container">
                <!-- container -->
            </div>
            <!-- /container -->
        </div>
	</body>
</html>